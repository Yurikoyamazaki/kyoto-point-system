# セキュリティ仕様

## 個人情報保護

### 取得情報
- 基本4情報のみ（氏名、住所、生年月日、性別）
- 個人番号（マイナンバー）は取得・保存しない

### データ保管
- 日本国内のAWSリージョン（ap-northeast-1）
- 暗号化: AES-256
- アクセス制御: IAM + VPC

## 認証方式

### マイナンバーカード認証
- 署名用電子証明書
- 利用者証明用電子証明書
- J-LISへの有効性確認

### 管理者認証
- 多要素認証（MFA）必須
- パスワードポリシー: 12文字以上、複雑性要件
- セッションタイムアウト: 30分

## 不正防止

### 重複防止
- カードID重複チェック
- 1ユーザー1ID徹底

### ポイント不正使用防止
- トランザクションID管理
- 二重使用検知
- リアルタイム残高チェック

### QRコード不正防止
- タイムスタンプ検証
- ワンタイムトークン
- 加盟店検証

## 監査ログ

### 記録内容
- ログイン履歴
- 操作履歴
- データアクセス履歴
- API呼び出し履歴

### 保管期間
- 最低2年間
- 改ざん防止措置（S3 Object Lock）

## 脆弱性対策

### OWASP Top 10対応
1. インジェクション: パラメータ化クエリ
2. 認証の不備: JWT + MFA
3. データ露出: 暗号化 + アクセス制御
4. XXE: XML処理無効化
5. アクセス制御の不備: RBAC実装
6. セキュリティ設定ミス: 自動スキャン
7. XSS: 入力検証 + エスケープ
8. 安全でないデシリアライゼーション: 署名検証
9. 既知の脆弱性: 定期更新
10. 不十分なロギング: 包括的監査ログ

### 脆弱性診断
- 開発完了時: 必須
- 機能追加時: 必須
- 定期診断: 年2回
- 診断基準: デジタル庁ガイドライン準拠
